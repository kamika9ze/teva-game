"use strict";function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _get=function t(e,s,o){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,s);if(void 0===i){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,s,o)}if("value"in i)return i.value;var a=i.get;if(void 0!==a)return a.call(o)},_createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var o=e[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,s,o){return s&&t(e.prototype,s),o&&t(e,o),e}}();document.addEventListener("DOMContentLoaded",function(t){var e=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._m=t.modal}},{key:"show",value:function(){document.body.classList.add("page_modal_show")}},{key:"hide",value:function(t){t.preventDefault(),document.body.classList.remove("page_modal_show")}}]),t}(),s=new e,o=new(function(t){function s(){return _classCallCheck(this,s),_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).apply(this,arguments))}return _inherits(s,e),_createClass(s,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._m=t.modal,this._mAns=this._m.querySelector(".modal__answer"),this._mPrc=this._m.querySelector(".modal__value_precision"),this._mPc=this._m.querySelector(".modal__value_price")}},{key:"show",value:function(t,e,o){this._mPrc.innerHTML=t+"%",this._mPc.innerHTML=e+" руб.<sup>*</sup>",this._mAns.innerHTML=o,_get(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"show",this).call(this)}}]),s}()),i=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(){this._slider=document.querySelector(".game__scale"),this._thumb=this._slider.querySelector(".game__box-img"),this._amount=document.querySelector(".game__amount"),this._val=this._amount.value,this._maxVal=this._amount.max,this._minVal=this._amount.min,this._price=this.getPrice(),this._step=this._maxVal/6,this._lastShitY=null,this._played=null,this.enable()}},{key:"enable",value:function(){this._thumb.addEventListener("mousedown",this._drag.bind(this)),this._thumb.addEventListener("touchstart",this._drag.bind(this))}},{key:"_drag",value:function(t){document.body.classList.add("page_hidden");var e=t.touches?t.touches[0].pageY:t.pageY;this._shiftY=e-this._getTopCoord(),this._played||(this._moveF=this._move.bind(this),this._dropF=this._drop.bind(this)),this._thumb.addEventListener("mousemove",this._moveF),this._thumb.addEventListener("touchmove",this._moveF),document.addEventListener("mouseup",this._dropF),document.addEventListener("touchend",this._dropF),document.addEventListener("touchcancel",this._dropF),t.preventDefault()}},{key:"_move",value:function(t){var e=(t.changedTouches?t.changedTouches[0].pageY:t.pageY)-this._shiftY;return this._lastShitY||(this._lastShitY=e),this._translateY=-(this._lastShitY-e),this._translateY>150?(this._translateY=150,this.setTranslateY(),void this.showValue()):this._translateY<-150?(this._translateY=-150,this.setTranslateY(),void this.showValue()):(this.showValue(),void this.setTranslateY())}},{key:"_drop",value:function(){document.body.classList.remove("page_hidden"),this._thumb.removeEventListener("mousemove",this._moveF),this._thumb.removeEventListener("touchmove",this._moveF),document.removeEventListener("touchend",this._dropF),this._played=!0}},{key:"showValue",value:function(){this._amount.value=this._getValue()}},{key:"setTranslateY",value:function(){this._thumb.style.transform="translateY("+this._translateY+"px)"}},{key:"_getTopCoord",value:function(){return this._thumb.getBoundingClientRect().top}},{key:"getPrecision",value:function(){return this._getValue()>=this._price&&this._getValue()<=2*this._price?Math.round(Math.abs(this._getValue()*(100/this._price)-200)):this._getValue()<=this._price?Math.round(this._getValue()*(100/this._price)):0}},{key:"_getValue",value:function(){return this._translateY||(this._translateY=0),Math.round((150-this._translateY)*this._step/50)}},{key:"getPrice",value:function(){return this._amount.dataset.price}},{key:"getAmount",value:function(){return this._amount}}]),t}());(new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(){var t=this;if(this._isMainPage=document.body.classList.contains("page_main"),this._isResultsPage=document.body.classList.contains("page_results"),this._isMainPage){document.querySelector(".drugs").addEventListener("click",function(e){var s=e.target.closest("[data-group]");s&&t._setGroup(s.pathname)}),this._clearStorage()}if(this._isResultsPage){this._rc=document.querySelector(".results__count");var e=document.querySelector(".link_repeat");e&&(e.href=this._getGroup(),e.addEventListener("click",function(e){t._clearStorage()})),this._showResults()}var s=document.querySelector("[data-complete]");s&&(localStorage.setItem("complete",s.dataset.complete),s.addEventListener("click",function(e){e.preventDefault();var s=t._getResults(),o=Math.round(100*s.count/s.complete);console.dir(o),window.location=100==o?"https://files.doktornarabote.ru/S.Amasev/teva_v2/results.html":o>=50?"https://files.doktornarabote.ru/S.Amasev/teva_v2/results_1.html":"https://files.doktornarabote.ru/S.Amasev/teva_v2/results_2.html"})),localStorage.getItem("count")||localStorage.setItem("count",0),this._msgs=["Верно!","Вы были близки <br> к правильному ответу!","Хорошая попытка, <br> но данный препарат доступнее <br> для пациентов!","Хорошая попытка, но данный <br> препарат относится к средней <br> ценовой категории!"],this._clss=["page_modal_correct","page_modal_close","page_modal_afford","page_modal_average"],this._modal(),this._modal_game(),this._slider()}},{key:"_modal",value:function(){this._m=document.querySelector(".modal"),this._isMainPage&&this._m&&(s.init(),s.show(),this._mHideAct=this._m.querySelector("[data-hide]"),this._mHideAct.addEventListener("click",s.hide))}},{key:"_modal_game",value:function(){var t=this;if(this._mg=document.querySelector(".game__modal"),this._mg){var e=function(t){document.body.classList.add(t)};o.init({modal:this._mg});document.querySelector("[data-show]").addEventListener("click",function(s){var n=i.getPrecision(),a=i.getPrice(),r=i._getValue(),u=null,l=i.getAmount();var index = window.location.href.lastIndexOf('/') + 1; ga('send', 'event', 'select', window.location.href.slice(index, -5), r + '');n>=90?(e(t._clss[0]),u=t._msgs[0],t._setCount()):n>=80?(e(t._clss[1]),u=t._msgs[1],t._setCount()):r>a?(e(t._clss[2]),u=t._msgs[2]):(e(t._clss[3]),u=t._msgs[3]),l.disabled=!0,o.show(n,a,u)})}}},{key:"_slider",value:function(){this._s=document.querySelector(".slider"),this._s&&i.init()}},{key:"_setCount",value:function(){var t=localStorage.getItem("count");localStorage.setItem("count",++t)}},{key:"_clearStorage",value:function(){localStorage.removeItem("count"),localStorage.removeItem("complete")}},{key:"_showResults",value:function(){var t=this._getResults(),e=t.count,s=t.complete;this._rc.innerHTML=e+" из "+s}},{key:"_getResults",value:function(){return{count:localStorage.getItem("count"),complete:localStorage.getItem("complete")}}},{key:"_setGroup",value:function(t){localStorage.setItem("group",t)}},{key:"_getGroup",value:function(){return localStorage.getItem("group")}}]),t}())).init()});